"use strict";(self.webpackChunkfabric_gatsby5=self.webpackChunkfabric_gatsby5||[]).push([[486],{9059:function(e,n,t){t.r(n),t.d(n,{default:function(){return v}});var a=t(1151),c=t(7294),o=t(8948);const r="\n  const canvas = new fabric.Canvas(canvasEl);\n\n  // create a rect object\n  const deleteIcon =\n    \"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E\";\n\n  var img = document.createElement('img');\n  img.src = deleteIcon;\n\n  fabric.Object.prototype.transparentCorners = false;\n  fabric.Object.prototype.cornerColor = 'blue';\n  fabric.Object.prototype.cornerStyle = 'circle';\n\n  function Add() {\n    const rect = new fabric.Rect({\n      left: 100,\n      top: 50,\n      fill: 'yellow',\n      width: 200,\n      height: 100,\n      objectCaching: false,\n      stroke: 'lightgreen',\n      strokeWidth: 4,\n    });\n\n    rect.controls.deleteControl = new fabric.Control({\n      x: 0.5,\n      y: -0.5,\n      offsetY: 16,\n      cursorStyle: 'pointer',\n      mouseUpHandler: deleteObject,\n      render: renderIcon,\n      cornerSize: 24,\n    });\n\n    canvas.add(rect);\n    canvas.setActiveObject(rect);\n  }\n\n  document.getElementById('add').onclick = () => Add();\n\n  Add();\n\n  function deleteObject(eventData, transform) {\n    const canvas = transform.target.canvas;\n    canvas.remove(transform.target);\n    canvas.requestRenderAll();\n  }\n\n  function renderIcon(ctx, left, top, styleOverride, fabricObject) {\n    const size = this.cornerSize;\n    ctx.save();\n    ctx.translate(left, top);\n    ctx.rotate(fabric.util.degreesToRadians(fabricObject.angle));\n    ctx.drawImage(img, -size / 2, -size / 2, size, size);\n    ctx.restore();\n  }\n",s="\n  const canvas = new fabric.Canvas(canvasEl);\n\n  // create a rect object\n  var deleteIcon =\n    \"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E\";\n\n  var cloneIcon =\n    \"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='iso-8859-1'%3F%3E%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 55.699 55.699' width='100px' height='100px' xml:space='preserve'%3E%3Cpath style='fill:%23010002;' d='M51.51,18.001c-0.006-0.085-0.022-0.167-0.05-0.248c-0.012-0.034-0.02-0.067-0.035-0.1 c-0.049-0.106-0.109-0.206-0.194-0.291v-0.001l0,0c0,0-0.001-0.001-0.001-0.002L34.161,0.293c-0.086-0.087-0.188-0.148-0.295-0.197 c-0.027-0.013-0.057-0.02-0.086-0.03c-0.086-0.029-0.174-0.048-0.265-0.053C33.494,0.011,33.475,0,33.453,0H22.177 c-3.678,0-6.669,2.992-6.669,6.67v1.674h-4.663c-3.678,0-6.67,2.992-6.67,6.67V49.03c0,3.678,2.992,6.669,6.67,6.669h22.677 c3.677,0,6.669-2.991,6.669-6.669v-1.675h4.664c3.678,0,6.669-2.991,6.669-6.669V18.069C51.524,18.045,51.512,18.025,51.51,18.001z M34.454,3.414l13.655,13.655h-8.985c-2.575,0-4.67-2.095-4.67-4.67V3.414z M38.191,49.029c0,2.574-2.095,4.669-4.669,4.669H10.845 c-2.575,0-4.67-2.095-4.67-4.669V15.014c0-2.575,2.095-4.67,4.67-4.67h5.663h4.614v10.399c0,3.678,2.991,6.669,6.668,6.669h10.4 v18.942L38.191,49.029L38.191,49.029z M36.777,25.412h-8.986c-2.574,0-4.668-2.094-4.668-4.669v-8.985L36.777,25.412z M44.855,45.355h-4.664V26.412c0-0.023-0.012-0.044-0.014-0.067c-0.006-0.085-0.021-0.167-0.049-0.249 c-0.012-0.033-0.021-0.066-0.036-0.1c-0.048-0.105-0.109-0.205-0.194-0.29l0,0l0,0c0-0.001-0.001-0.002-0.001-0.002L22.829,8.637 c-0.087-0.086-0.188-0.147-0.295-0.196c-0.029-0.013-0.058-0.021-0.088-0.031c-0.086-0.03-0.172-0.048-0.263-0.053 c-0.021-0.002-0.04-0.013-0.062-0.013h-4.614V6.67c0-2.575,2.095-4.67,4.669-4.67h10.277v10.4c0,3.678,2.992,6.67,6.67,6.67h10.399 v21.616C49.524,43.26,47.429,45.355,44.855,45.355z'/%3E%3C/svg%3E%0A\";\n\n  var deleteImg = document.createElement('img');\n  deleteImg.src = deleteIcon;\n\n  var cloneImg = document.createElement('img');\n  cloneImg.src = cloneIcon;\n\n  fabric.Object.prototype.transparentCorners = false;\n  fabric.Object.prototype.cornerColor = 'blue';\n  fabric.Object.prototype.cornerStyle = 'circle';\n\n  function renderIcon(icon) {\n    return function renderIcon(ctx, left, top, styleOverride, fabricObject) {\n      var size = this.cornerSize;\n      ctx.save();\n      ctx.translate(left, top);\n      ctx.rotate(fabric.util.degreesToRadians(fabricObject.angle));\n      ctx.drawImage(icon, -size / 2, -size / 2, size, size);\n      ctx.restore();\n    };\n  }\n\n  function deleteObject(eventData, target) {\n    var canvas = target.canvas;\n    canvas.remove(target);\n    canvas.requestRenderAll();\n  }\n\n  function cloneObject(eventData, transform) {\n    var canvas = transform.target.canvas;\n    transform.target.clone().then((cloned) => {\n      cloned.left += 10;\n      cloned.top += 10;\n      canvas.add(cloned);\n    });\n  }\n\n  function Add() {\n    var rect = new fabric.Rect({\n      left: 100,\n      top: 50,\n      fill: 'yellow',\n      width: 200,\n      height: 100,\n      objectCaching: false,\n      stroke: 'lightgreen',\n      strokeWidth: 4,\n    });\n\n    rect.controls.deleteControl = new fabric.Control({\n      x: 0.5,\n      y: -0.5,\n      offsetY: -16,\n      offsetX: 16,\n      cursorStyle: 'pointer',\n      mouseUpHandler: deleteObject,\n      render: renderIcon(deleteImg),\n      cornerSize: 24,\n    });\n\n    rect.controls.clone = new fabric.Control({\n      x: -0.5,\n      y: -0.5,\n      offsetY: -16,\n      offsetX: -16,\n      cursorStyle: 'pointer',\n      mouseUpHandler: cloneObject,\n      render: renderIcon(cloneImg),\n      cornerSize: 24,\n    });\n\n    canvas.add(rect);\n    canvas.setActiveObject(rect);\n  }\n\n  Add();\n";function l(e){const n=Object.assign({p:"p",ul:"ul",li:"li",h2:"h2",a:"a",span:"span"},(0,a.ah)(),e.components);return c.createElement(c.Fragment,null,c.createElement(n.p,null,"This demo show how to start using the custom controls api.\nThis first example show how to write a custom render method for your control and how to define a custom action to run on the control mouseup.\nThe new api offers the ability to run custom actions on:"),"\n",c.createElement(n.ul,null,"\n",c.createElement(n.li,null,"mousedown"),"\n",c.createElement(n.li,null,"mouseup"),"\n",c.createElement(n.li,null,"mousemove"),"\n"),"\n",c.createElement(n.p,null,"And to run custom code for"),"\n",c.createElement(n.ul,null,"\n",c.createElement(n.li,null,"positioning"),"\n",c.createElement(n.li,null,"rendering"),"\n",c.createElement(n.li,null,"cursor style"),"\n"),"\n",c.createElement(n.h2,{id:"creating-the-control",style:{position:"relative"}},"Creating the control",c.createElement(n.a,{href:"#creating-the-control","aria-label":"creating the control permalink",className:"anchor after"},c.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",c.createElement(n.p,null,"We create a new control and we add it to the object.\nTo create a control we use ",c.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">fabric<span class="token punctuation">.</span>Control</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span></code>'}}),"\nIn this case we want the corner to be near the top right classic control, so we give it a position of x of 0.5 that is the extreme right of the bounding box of the object.\nSame for y at -0.5. We do not want it to overlap with the current top right corner, so we add an ",c.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">offsetY</code>'}})," with a positive number that will make it render a bit more down."),"\n",c.createElement(n.p,null,"We want our control to render an icon rather than a fabric supported circle or square.\nSo we have to provide our own render function to the control.\nThe function is receiving the canvas context as first argument and so a simple drawImage will make it."),"\n",c.createElement(n.p,null,"For the custom action we want simply to delete the object.\nWe build a function following the mouseUpHandler signature and we use there ",c.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-javascript">canvas<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span></code>'}}),";"),"\n",c.createElement("div",{className:"controls"},c.createElement("p",null,c.createElement("button",{id:"add"},"Add a rectangle"))),"\n",c.createElement(o.p,{code:r,canvasId:"test1"},c.createElement("canvas",{width:"600",height:"500",id:"test1"})),"\n",c.createElement(n.h2,{id:"adding-a-clone-control",style:{position:"relative"}},"Adding a clone control",c.createElement(n.a,{href:"#adding-a-clone-control","aria-label":"adding a clone control permalink",className:"anchor after"},c.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",c.createElement(n.p,null,"Let's add a new control to allow for quick duplication of the Object.\nWe use again ",c.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">fabric<span class="token punctuation">.</span>Control</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span></code>'}})," and we add it to a key named ",c.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">clone</code>'}}),".\nWhen the objects are shrunk too much, corners with offset do not look great, so in this case\nlet's try to keep them outside the bounding box, on the top."),"\n",c.createElement(n.p,null,"For the clone functionality we will simply do ",c.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-javascript">target<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cloned</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> canvas<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cloned<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>'}})),"\n",c.createElement("div",{className:"controls"},c.createElement("p",null,c.createElement("button",{id:"add2"},"Add a rectangle"))),"\n",c.createElement(o.p,{code:s,canvasId:"test2"},c.createElement("canvas",{width:"600",height:"500",id:"test2"})))}var i=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?c.createElement(n,e,c.createElement(l,e)):l(e)},d=t(4160),p=t(6422),u=t(1202),m=t(6330),h=t(2059);function g(e){let{data:n,pageContext:t,children:a}=e;const{frontmatter:o,mdFile:r}=n.demoPage;return c.createElement(p.Z,null,c.createElement(h.Z,{title:o.title}),c.createElement("nav",{id:"breadcrumb-nav","aria-label":"breadcrumb"},c.createElement(d.rU,{to:"/demos"},"Demos")," > ",c.createElement("span",null,o.title)),c.createElement("h1",null,o.title),c.createElement("article",null,a),c.createElement(u.Z,{relativePath:r.relativePath}),c.createElement(m.Z,{prev:t.prev||{title:"All FabricJS demos",slug:"/demos"},next:t.next}))}function v(e){return c.createElement(g,e,c.createElement(i,e))}}}]);
//# sourceMappingURL=component---src-templates-demo-jsx-content-file-path-src-content-demo-custom-controls-index-md-8eb0624ee70f4ee5b56c.js.map